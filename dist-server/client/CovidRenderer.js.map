{"version":3,"sources":["../../src/client/CovidRenderer.js"],"names":["game","app","client","BUTTON","LEFT","MIDDLE","RIGHT","GameRenderer","gameEngine","clientEngine","PIXI","Application","width","height","antialias","stop","cardSprites","Map","isReady","dragging","selecting","selection","document","body","querySelector","appendChild","renderer","view","stage","backgroundSprite","Sprite","loader","resources","background","texture","zIndex","addChild","sortableChildren","sortDirty","start","selectingCounter","BitmapText","font","name","size","tint","anchor","set","alpha","angle","renderable","selectingBox","Graphics","updateSelectingBox","sel","count","clear","lineStyle","beginFill","drawRect","x","y","end","endFill","text","table","interactive","that","applySelection","ids","forEach","v","k","center","toLocal","getGlobalPosition","push","on","e","data","button","pos","getLocalPosition","Math","round","length","min","max","onMouseUp","readyState","onDOMLoaded","addEventListener","bind","Promise","resolve","reject","add","Object","keys","ASSETPATHS","map","url","load","setupStage","isTouchDevice","classList","isMacintosh","isWindows","emit","preventDefault","obj","card_container","Container","frontSprite","cardSheet","textures","model","backSprite","setupCardInteraction","id","container","mouseIsOver","sel_index","indexOf","tmp","sendInput","toString","autoAlignCardOnInteractionEnabled","rel","dist","hypot","objId","rotate","Card","WIDTH","prevPos","initialLocalDist","pivotGlobal","prevMousePos","clone","currMousePos","copyTo","dx","dy","xRelFrom","yRelFrom","xRelTo","yRelTo","distFrom","distTo","dm","angleFrom","atan2","angleTo","deltaAngle","PI","dragEnd","get","delete","destroy","t","dt","world","forEachObject","order","rotation","position","side","SIDE","FRONT","BACK","render","comfortaaFont","Renderer","navigator","platform","window","maxTouchPoints"],"mappings":"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","sourcesContent":["import { Renderer } from 'lance-gg';\nimport Card from './../common/Card';\nimport * as filters from 'pixi-filters';\nimport * as PIXI from 'pixi.js';\n\nlet game = null;\nlet app = null;\nlet client = null;\nconst BUTTON = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\nexport default class GameRenderer extends Renderer {\n\n  constructor(gameEngine, clientEngine) {\n    super(gameEngine, clientEngine);\n    game = gameEngine;\n    client = clientEngine;\n    app = new PIXI.Application({\n      width: 800,\n      height: 800,\n      antialias: true,\n    });\n    app.stop()\n    this.cardSprites = new Map();\n    this.isReady = false; // Whether the Sprites are loaded and renderer is ready\n    this.dragging = null;\n    this.selecting = null;\n    this.selection = []\n  }\n\n  get ASSETPATHS() {\n    return {\n      background: 'assets/wood.png',\n      cardSheet: 'assets/cards.json',\n      comfortaaFont: 'assets/comfortaa.xml'\n    };\n  }\n\n  setupStage() {\n    document.body.querySelector('.pixiContainer').appendChild(app.renderer.view);\n    app.stage.backgroundSprite = new PIXI.Sprite(app.loader.resources.background.texture);\n    app.stage.backgroundSprite.width = app.renderer.width;\n    app.stage.backgroundSprite.height = app.renderer.height;\n    app.stage.backgroundSprite.zIndex = 0;\n    app.stage.addChild(app.stage.backgroundSprite);\n    app.stage.sortableChildren = true;\n    app.stage.sortDirty = true;\n    app.start();\n\n    let selectingCounter = new PIXI.BitmapText(\"1\", {font: { name: \"Comfortaa\", size: 100 }, tint: 0xFFFFFF});\n    selectingCounter.anchor.set(0.5, 0.5);\n    selectingCounter.zIndex = 1001;\n    selectingCounter.alpha = 0.6;\n    selectingCounter.angle = 180;\n    selectingCounter.renderable = false;\n    app.stage.selectingCounter = selectingCounter;\n    app.stage.addChild(selectingCounter);\n    let selectingBox = new PIXI.Graphics();\n    selectingBox.zIndex = 1000;\n    app.stage.selectingBox = selectingBox;\n    app.stage.addChild(selectingBox);\n    function updateSelectingBox(sel, count) {\n      selectingBox.clear();\n      selectingCounter.renderable = false;\n      if (sel !== null) {\n        selectingBox.lineStyle(1, 0xffffff, 1);\n        selectingBox.beginFill(0xffffff, 0.2);\n        selectingBox.drawRect(\n          sel.start.x+.5, sel.start.y+.5, sel.end.x - sel.start.x, sel.end.y - sel.start.y);\n        selectingBox.endFill();\n        if (count > 0) {\n          selectingCounter.renderable = true;\n          selectingCounter.x = (sel.start.x + sel.end.x) / 2;\n          selectingCounter.y = (sel.start.y + sel.end.y) / 2;\n          selectingCounter.text = count;\n        }\n      }\n    }\n\n    const table = app.stage.backgroundSprite;\n    table.interactive = true;\n    const that = this;\n    // Reactangular selection\n    function applySelection() {\n      let ids = [];\n      that.cardSprites.forEach((v, k) => {\n        let center = app.stage.toLocal(v.getGlobalPosition());\n        if (((that.selecting.start.x < center.x && center.x < that.selecting.end.x)\n          || (that.selecting.start.x > center.x && center.x > that.selecting.end.x))\n          && ((that.selecting.start.y < center.y && center.y < that.selecting.end.y)\n            || (that.selecting.start.y > center.y && center.y > that.selecting.end.y))) {\n          ids.push(k);\n        }\n      });\n      return ids;\n    }\n    table.on(\"mousedown\", function(e) {\n      if (e.data.button === BUTTON.LEFT) {\n        let pos = e.data.getLocalPosition(app.stage)\n        pos.x = Math.round(pos.x);\n        pos.y = Math.round(pos.y);\n        that.selecting = { start: pos, end: pos };\n        that.selection = [];\n        updateSelectingBox(that.selecting, that.selection.length);\n      }\n    });\n    table.on(\"mousemove\", function(e) {\n      if (that.selecting !== null) {\n        let pos = e.data.getLocalPosition(app.stage)\n        pos.x = Math.round(Math.min(Math.max(pos.x, 0), app.renderer.width));\n        pos.y = Math.round(Math.min(Math.max(pos.y, 0), app.renderer.height));\n        that.selecting.end = pos;\n        updateSelectingBox(that.selecting, that.selection.length);\n        that.selection = applySelection();\n      }\n    });\n    function onMouseUp(e) {\n      if (e.data.button === BUTTON.LEFT) {\n        if (that.selecting !== null) {\n          that.selection = applySelection();\n          that.selecting = null;\n          updateSelectingBox(that.selecting, 0);\n        }\n      }\n    }\n    table.on(\"mouseup\", onMouseUp);\n    table.on(\"mouseupoutside\", onMouseUp);\n\n    //this.dropShadowFilter = new filters.DropShadowFilter({\n    //  color: 0x000000,\n    //  alpha: 0.5,\n    //  blur: 2,\n    //  quality: 2,\n    //  distance: 0\n    //});\n  }\n\n  init() {\n    if (document.readyState === 'complete' ||\n        document.readyState === 'loaded' ||\n        document.readyState === 'interactive')\n      this.onDOMLoaded();\n    else\n      document.addEventListener('DOMContentLoaded', this.onDOMLoaded.bind(this));\n\n    return new Promise((resolve, reject) => {\n      app.loader.add(Object.keys(this.ASSETPATHS).map((x) => {\n          return { name: x, url: this.ASSETPATHS[x] };\n      }))\n      .load(() => {\n        this.isReady = true;\n        this.setupStage();\n\n        if (isTouchDevice()) document.body.classList.add('touch');\n        else if (isMacintosh()) document.body.classList.add('mac');\n        else if (isWindows()) document.body.classList.add('pc');\n        resolve();\n        this.gameEngine.emit('renderer.ready');\n        });\n      });\n  }\n\n  onDOMLoaded() {\n    app.renderer.view.addEventListener(\"contextmenu\", function(e){\n      e.preventDefault();\n    }, false);\n  }\n\n  // Add a single Card game object\n  addCard(obj) {\n    let card_container = new PIXI.Container();\n    let frontSprite = new PIXI.Sprite(app.loader.resources.cardSheet.textures[obj.model+\".png\"]);\n    let backSprite = new PIXI.Sprite(app.loader.resources.cardSheet.textures[\"back.png\"]);\n    card_container.addChild(frontSprite);\n    card_container.addChild(backSprite);\n    card_container.frontSprite = frontSprite;\n    card_container.backSprite = backSprite;\n\n    frontSprite.anchor.set(0.5, 0.5);\n    backSprite.anchor.set(0.5, 0.5);\n    //frontSprite.filters = [this.dropShadowFilter];\n    //backSprite.filters = [this.dropShadowFilter];\n    //frontSprite.visible = obj.side === Card.SIDE.FRONT;\n    //backSprite.visible = obj.side === Card.SIDE.BACK;\n\n    this.setupCardInteraction(obj, card_container);\n\n    app.stage.addChild(card_container);\n    this.cardSprites.set(obj.id, card_container);\n  }\n\n  setupCardInteraction(obj, container) {\n    const that = this;\n    container.interactive = true;\n    // Over\n    container.on(\"mouseover\", function(e) {\n      container.mouseIsOver = true;\n    });\n    container.on(\"mouseout\", function(e) {\n      container.mouseIsOver = false;\n    });\n    // Flip\n    container.on(\"rightclick\", function(e) {\n      // Update selection\n      let sel_index = that.selection.indexOf(obj.id);\n      if (sel_index !== -1) {\n        let tmp = that.selection[0];\n        that.selection[0] = that.selection[sel_index];\n        that.selection[sel_index] = tmp;\n      } else {\n        that.selection = [obj.id];\n      }\n      let ids = that.selection;\n      client.sendInput(\"flip \" + ids.toString());\n      client.sendInput(\"top \" + ids.toString());\n      if (client.autoAlignCardOnInteractionEnabled && ids.length === 1)\n        client.sendInput(\"orientation \" + 0 + \" \" + ids.toString());\n      // restore selection\n      if (sel_index === -1) {\n        that.selection = [];\n      }\n    });\n    // Drag Start\n    container.on(\"mousedown\", function(e) {\n      if (e.data.button == BUTTON.LEFT) {\n        let sel_index = that.selection.indexOf(obj.id);\n        if (sel_index === -1) {\n          // clear selection, create one card selection\n          that.selection = [obj.id];\n        }\n        let ids = that.selection;\n\n        let rel = e.data.getLocalPosition(container);\n        let pos = e.data.getLocalPosition(app.stage);\n        let dist = Math.hypot(rel.x, rel.y);\n        that.dragging = {\n          objId: obj.id,\n          rotate: dist > Card.WIDTH / 2,\n          prevPos: pos,\n          initialLocalDist: dist,\n          pivotGlobal: app.stage.toLocal(container.getGlobalPosition())\n        };\n        if (client.autoAlignCardOnInteractionEnabled && ids.length === 1 && !that.dragging.rotate)\n          client.sendInput(\"orientation \" + 0 + \" \" + ids.toString());\n        client.sendInput(\"top \" + ids.toString());\n      }\n    });\n    // Drag Move\n    container.on(\"mousemove\", function(e) {\n      if (that.dragging && that.dragging.objId === obj.id) {\n        let ids = that.selection;\n        let prevMousePos = that.dragging.prevPos.clone();\n        let currMousePos = e.data.getLocalPosition(app.stage);\n        currMousePos.copyTo(that.dragging.prevPos);\n\n        if (!that.dragging.rotate || ids.length > 1) {\n          let dx = currMousePos.x - prevMousePos.x;\n          let dy = currMousePos.y - prevMousePos.y;\n          client.sendInput(\"move \"+[dx,dy].toString()+\" \"+ids.toString());\n        } else {\n          let xRelFrom = prevMousePos.x - that.dragging.pivotGlobal.x;\n          let yRelFrom = prevMousePos.y - that.dragging.pivotGlobal.y;\n          let xRelTo = currMousePos.x - that.dragging.pivotGlobal.x;\n          let yRelTo = currMousePos.y - that.dragging.pivotGlobal.y;\n          let distFrom = Math.hypot(xRelFrom, yRelFrom);\n          let distTo = Math.hypot(xRelTo, yRelTo);\n          // Do not push the card, only pull is allowed (and if the move has been\n          // interrupted, resume it if only when we reached the initial anchor point)\n          if (distTo > distFrom && distTo > that.dragging.initialLocalDist) {\n            let dm = distTo - that.dragging.initialLocalDist;\n            let dx = xRelTo * dm / distTo;\n            let dy = yRelTo * dm / distTo;\n            that.dragging.pivotGlobal.x += dx;\n            that.dragging.pivotGlobal.y += dy;\n            client.sendInput(\"move \"+[dx,dy].toString()+\" \"+[obj.id].toString());\n          }\n          let angleFrom = Math.atan2(yRelFrom, xRelFrom);\n          let angleTo = Math.atan2(yRelTo, xRelTo);\n          let deltaAngle = (angleTo - angleFrom) * 180 / Math.PI;\n          client.sendInput(\"rotate \"+deltaAngle+\" \"+[obj.id].toString());\n        }\n      }\n    });\n    // Drag End\n    function dragEnd(e) {\n      if (e.data.button == BUTTON.LEFT) {\n        that.dragging = null;\n        // clear selection\n        if (that.selection.length === 1) {\n          that.selection = [];\n        }\n      }\n    }\n    container.on(\"mouseupoutside\", dragEnd);\n    container.on(\"mouseup\", dragEnd);\n  }\n\n  removeCard(obj) {\n    let card_container = this.cardSprites.get(obj.id);\n    if (card_container) {\n      this.cardSprites.delete(obj.id);\n      if (card_container.frontSprite) card_container.frontSprite.destroy();\n      frontSprite.destroy();\n      if (card_container.backSprite) card_container.backSprite.destroy();\n      backSprite.destroy();\n    }\n  }\n\n  draw(t, dt) {\n    super.draw(t, dt);\n    if (!this.isReady) return; // lance-gg and pixi's sprites not loaded yet\n\n    game.world.forEachObject((id, obj) => {\n      if (obj instanceof Card) {\n        let card_container = this.cardSprites.get(obj.id);\n        card_container.zIndex = obj.order;\n        card_container.rotation = obj.angle * Math.PI / 180;\n        card_container.x = obj.position.x;\n        card_container.y = obj.position.y;\n        card_container.frontSprite.renderable = obj.side === Card.SIDE.FRONT;\n        card_container.backSprite.renderable = obj.side === Card.SIDE.BACK;\n        if ((this.selection.indexOf(obj.id) !== -1 && this.dragging ===  null)\n            || (card_container.mouseIsOver && this.dragging === null && this.selecting === null)) {\n          card_container.frontSprite.tint = 0xAAAAAA;\n          card_container.backSprite.tint = 0xAAAAAA;\n        } else {\n          card_container.frontSprite.tint = 0xFFFFFF;\n          card_container.backSprite.tint = 0xFFFFFF;\n        }\n      }\n    });\n    app.renderer.render(app.stage);\n  }\n}\n\nfunction isMacintosh() { return navigator.platform.indexOf('Mac') > -1; }\nfunction isWindows() { return navigator.platform.indexOf('Win') > -1; }\nfunction isTouchDevice() { return 'ontouchstart' in window || navigator.maxTouchPoints; }\n"],"file":"CovidRenderer.js"}